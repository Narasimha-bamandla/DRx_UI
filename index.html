<!DOCTYPE html>
<html>

<head>
    <title>Chatbot Widget</title>

    <!--Let browser know website is optimized for mobile-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!--Import Google Icon Font-->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Raleway:500&display=swap" rel="stylesheet">

    <!--Import Font Awesome Icon Font-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

    <!--Import materialize.css-->
    <link rel="stylesheet" type="text/css" href="static/css/materialize.min.css">

    <!--Main css-->
    <link rel="stylesheet" type="text/css" href="static/css/style.css">
    <meta name="viewport" content="width=device-width, initial-scale=1">

</head>

<body>
    <div class="container">

        <!--chatbot widget -->
        <div class="widget">
            <div class="chat_header">

                <!--Add the name of the bot here -->
                <i class="fa fa-stop-circle restart" id = "restart" style="font-size:24px"></i>
                <span class="chat_header_title">DRx Assistant</span>
                <i class="fa fa-window-minimize close" id = "close"  style="font-size:24px"></i>
            </div>

            <!--Chatbot contents goes here -->
            <div class="chats" id="chats">
                <div class="clearfix"></div>
            </div>

            <!--keypad for user to type the message -->
            <div class="row">
                <div class="keypad">
                    <div class="col s1"  > 
                        <div id="screenshotButton"><i class="fa fa-camera" aria-hidden="true"></i></div>
                    </div>
                    <div class="col s10">
                        <textarea id="userInput" placeholder="Type a message..." class="usrInput"></textarea>
                    </div>
                    <div class="col s1">
                        <div id="sendButton"><i class="fa fa-paper-plane" aria-hidden="true"></i></div>
                    </div>
                </div>
            </div>
			
        </div>

        <!--bot profile-->
        <div class="profile_div" id="profile_div">
            <img class="imgProfile" src="static/img/128_chat_icon.png" />
        </div>


    </div>

    <!--JavaScript at end of body for optimized loading-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script type="text/javascript" src="static/js/materialize.min.js"></script>

    <!-- Screenshot script - Starts -->
    <script type="text/javascript" src="static/js/html2canvas.js"></script>
    
    <!--Main Script -->
	<script type="text/javascript" src="static/js/config.js"></script>
    <script type="text/javascript" src="static/js/script.js"></script>

    <!--Chart.js Script -->
    <script type="text/javascript" src="static/js/chart.min.js"></script>
	
	


	<script type="text/javascript">
	  const capture = () => {
	  const body = document.querySelector('body');
	  body.id = 'capture';
	  
	  html2canvas(document.querySelector("#capture"),{
        allowTaint: false,
        useCORS: true
        }).then(canvas => {
		//document.querySelector('canvas').remove();
		document.body.appendChild(canvas);
	  }).then(() => {
	  
	  	var canvas = document.querySelector('canvas');
		canvas.style.display = 'none';
				
		var dataURL = canvas.toDataURL(); 
		$.ajax({ 
			type: "POST", 
			url: "script.php", 
			data: { 
				imgBase64: dataURL 
			} 
		}).done(function(data) { 
			localStorage.setItem('screenshotImg', location.href+data);
			console.log(localStorage.getItem('screenshotImg'));
		}); 

	  });
	};

	const btn = document.getElementById('screenshotButton');
	btn.addEventListener('click', capture)
	
	
	</script>
	<!-- Screenshot script - End -->

</body>

</html>